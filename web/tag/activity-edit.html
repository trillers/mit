<activity-edit>
    <!--<mask-loading show="{!ready}"></mask-loading>-->
    <div id="addactbody" if="{!hidden}">
        <div class="activity-new-statement">
            <p>提醒：活动内容包含违法、反动信息或者冒用他人/组织的名
                义发布活动，平台有权删除其活动并提交公安机关处理</p>
            <img src="/{env}/images/closebtn3.png" class="closebtn3" onclick="{closeStatement}" />
        </div>
        <form id="actform">
            <div class="activity-new-basic-info">
                <section>
                    <div class="secleft"><img src="/{env}/images/new1.png" /></div>
                    <div class="secright">
                        <input type="text" onfocus="{inputonfocus}" onblur="{inputonblur}" name="name" value="" placeholder=""/>
                    </div>
                </section>
                <section class="tag-type">
                    <div class="secleft"><p class="p1"><img src="/{env}/images/new2.png" /></p> <p class="p2" onclick="{showSelectType}">类型标签</p></div>
                    <div class="secright">
                        <ul>
                            <li each="{name,i in typetags}" data="{name}" class="{tagdefault:true,checked:parent.currtypetags.indexOf(name)>=0} {(i==3||i==7)?'no_m_left':''}" onclick="{parent.selecttags}">
                                <i>{__app.enums.TypeTags.values[name]}</i>
                            </li>
                        </ul>
                    </div>
                </section>
                <section class="activity-time">
                    <div class="secleft"><img src="/{env}/images/new3.png" /></div>
                    <div class="secright">
                        <div class="fl div_left">活动时间</div>
                        <div class="fl div_right">
                            <div id="startTimebtn" class="datediv">
                            <input type="text" id="startTimetxt" value="00/00" readonly="readonly"/>
                            <input id="startTime" onchange="{startchange}" onclick="{dateclick}" onblur="{dateblur}" name="startTime" style="display: inline-block;margin-top:0px;" type="date"/>
                        </div>
                            <i style="display:block;position:absolute;top:20px;left:43%;width:20px;height:1px;border-top:1px solid #ccc"></i>
                            <div id="endTimebtn" class="datedivright">
                                <input type="text" id="endTimetxt" value="00/00" readonly="readonly"/>
                                <input id="endTime" onchange="{endchange}" onclick="{dateclick}" onblur="{dateblur}" name="endTime" style="display: inline-block;margin-top:0px" type="date"/>
                            </div>
                        </div>

                    </div>
                </section>
                <section>
                    <div class="secleft"><img src="/{env}/images/new4.png" /></div>
                    <div class="secright">
                        <div></div>
                        <input type="text" onfocus="{inputonfocus}"  onblur="{inputonblur}" name="place" value="" placeholder=""/>
                    </div>
                </section>
                <section class="initiator">
                    <div class="secleft"><img src="/{env}/images/new5.png" /></div>
                    <div class="secright">
                        <div class="fl div_left">发起人</div>
                        <div class="fl div_right">
                            <div style="width:30%;float: left;line-height: 35px;"><input type="text" onfocus="{inputonfocus}" style="font-size:14px;"  onblur="{inputonblur}" name="initiatorName" placeholder="姓名"/></div>
                            <div style="width:70%;float:right;position:relative;line-height: 35px;"><span class="borderleft"></span><input type="text" onfocus="{inputonfocus}"  onblur="{inputonblur}" style="font-size:14px;" name="initiatorContact" placeholder="联系方式"/></div>
                        </div>
                    </div>
                </section>
                <section class="deadline">
                    <div class="secleft"><img src="/{env}/images/new6.png" /></div>
                    <div class="secright">
                        <div class="fl div_left">报名截止</div>
                        <div class="fl div_right">
                            <div class="datediv datediv360">
                                <input id="closingTimebtn" type="text" attr="closingTime" value="00/00" readonly="readonly"/>
                                <input id="closingTime" onchange="{closingchange}" onclick="{dateclick}" onblur="{dateblur}" name="closingTime" style="display: inline-block;" type="date"/>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <div class="activity-new-activity-introduction-title">
                <div class="activity_title">
                    <span></span>
                    活动介绍
                </div>
            </div>
            <div>
                <div id="editor"></div>
        <!--<textarea class="actintro" name="desc" onfocus="{inputonfocus}"  onblur="{inputonblur}">-->
<!--【活动说明】-->
<!--【活动日程】-->
<!--【费用说明】自行消费-->
<!--【集合时间】-->
<!--【集合地点】-->
<!--【交通方式】-->
<!--【报名说明】-->
<!--1、直接系统报名，报名名单中显示用户名字即报名成功；-->
<!--2、本活动不限名额。/本活动限x人，以报名先后确认名额。-->
<!--【温馨提示】-->
<!--1、-->
<!--2、-->
        <!--</textarea>-->
        </div>
            <div class="banner" onclick="{uploadimg}" if={test} style="position: relative">
                <div style="position: absolute;bottom:10px;right:10px;width:24px;height:24px;z-index: 100;">
                    <img style="width:24px;height:24px" src="/{env}/images/5.0.8.png"/>
                </div>
                <img style="width: 100%;" src="{picshow}" class="imgsetwidth"/>
            </div>
            <div class="banner" onclick="{uploadimg}" if="{!test}" style="position: relative">
                <div style="position: absolute;bottom:10px;right:10px;width:24px;height:24px;z-index: 100;">
                    <img style="width:24px;height:24px" src="/{env}/images/5.0.8.png"/>
                </div>
                <img id="banner" style="width: 100%;" src={imgsrc}/>
            </div>
            <div class="activity-new-more-options-title activity-new-more-options-title-checked" onclick="{moreOptions}">
                <div class="activity_title">
                    <span></span>
                    更多选项
                </div>
            </div>
            <div class="options activity-new-more-options" >
                <div class="new_hint_div1_div2">
                    <p>只允许被邀请的朋友参与</p>
                    <div class="but_wary" id="but_wary">
                        <p id="but_radius"></p>
                    </div>
                </div>
                <div class="user_options">
                    <div class="new_hint_div1_div3">
                        <p>报名填写项</p>
                    </div>
                    <ul onclick="{userOptions}">
                        <li each="{name,i in appFieldNameArr}" data="{name}" class="{parent.fieldIfSel(name) ? 'checked' : ''}">{__page.appFields[name].title}</li>
                    </ul>
                </div>
            </div>
            <div class="clear"></div>
            <div class="activity-new-presentation">
                <div>
                    <p class="new_hint_p1">提示:</p>
                    <p class="new_hint_p2">请确认活动内容后再发布!因为一旦发布并且有用户报名后,活动就不允许取消和修改了。</p>
                </div>
            </div>
            <div class="clear"></div>
            <div class="serv t-c">
                <p>使用过程中如有任何疑问请咨询客服</p>
                <p class="m_top10_media p2"><img src="/{env}/images/1_19.png" /> 客服电话：400-680-9072</p>
            </div>
            <div class="footer_placeholder"></div>
            <div class="footer" name="btnbox">
                <div onclick="{homepage}"></div>
                <div class="button but1" style="width:27%;" onclick="{submitdraft}">保存草稿</div>
                <div class="button but2" style="width:45%;" onclick="{publishpa}">立即发布</div>
            </div>
        </form>

    </div>


    <script>
        var self = nest.presentable(this);
        self.env = (__app.settings.env.NODE_ENV=="production")?"public":"web";
        console.log("env=" + self.env);
        var introImgs = {
            localIds:[],
            fileNames:[],
            serverIds:[],
            refresh: function(){
                this.localIds = [];
                this.serverIds = [];
                this.fileNames = [];
            }
        };
        var multiImgUpload = domain.action('multiImgUpload');
        //富文本编辑器
        var editor = new util.wedgt.WcEditor({
            modules:{
                Bold: true,
//                Size: true,
                Color: true,
                Img: true,
                TextAlign: true
            },
            container: 'editor'
        });
        var introImgsObjs = [];
        var currentImgShots = [], imgArr = [];
        var coverimgs = {
                localIds:[],
                serverIds:[],
                refresh:function(){
                    this.localIds = [];
                    this.serverIds = [];
                }
            },
            model = this.model = nest.modelable({},{
                url: __app.settings.api.url + "/pa/"
            }),
            imgmodel = this.imgmodel = nest.modelable({},{
                url: __app.settings.api.url + "/img/"
            }),
            startTimetxt = this.startTimetxt,
            startTime = this.startTime,
            endTimetxt = this.endTimetxt,
            endTime = this.endTime,
            closingTimebtn = this.closingTimebtn,
            closingTime = this.closingTime,
            name = this.name,
            place = this.place,
            initiator = __page.user.id,
            initiatorName = this.initiatorName,
            initiatorContact = this.initiatorContact,
            //desc = this.desc,
            actform = this.actform,
            btnbox = this.btnbox,
            newdate = new Date(__page.servertime);
        self.appFields = __page.appFields;
        self.appFieldNameArr = Object.keys(self.appFields);
        var enums_TypeTags = __app.enums.TypeTags.values;
        delete enums_TypeTags["ex"];
        delete enums_TypeTags["tn"];
        self.typetags = Object.keys(enums_TypeTags);
        self.actobj={
            txtareastr:'【活动说明】</br></br>【活动日程】</br>【费用说明】自行消费</br>【集合时间】</br>【集合地点】</br>【交通方式】</br>【报名说明】</br>1、直接系统报名，报名名单中显示用户名字即报名成功；</br>2、本活动不限名额。/本活动限x人，以报名先后确认名额。</br>【温馨提示】</br>1、</br>2、</br>',
            initPage:function(json){
                startTimetxt.value = json && json.startTime && util.dateFormat(new Date(json.startTime),'MM/dd')||util.dateFormat(newdate,'MM/dd');
                endTimetxt.value = json && json.endTime && util.dateFormat(new Date(json.endTime),'MM/dd')||util.dateFormat(newdate,'MM/dd');
                closingTimebtn.value=json && json.closingTime && util.dateFormat(new Date(json.closingTime),'MM/dd')||util.dateFormat(newdate,'MM/dd');
                name.value=json && json.name || "";
                startTime.value= json && json.startTime && util.dateFormat(new Date(json.startTime),'yyyy-MM-dd') || util.dateFormat(newdate,'yyyy-MM-dd');
                endTime.value= json && json.endTime && util.dateFormat(new Date(json.endTime),'yyyy-MM-dd') || util.dateFormat(newdate,'yyyy-MM-dd');
                closingTime.value = json && json.closingTime && util.dateFormat(new Date(json.closingTime),'yyyy-MM-dd') || util.dateFormat(newdate,'yyyy-MM-dd');
                place.value=json && json.place || "";
                initiator = __page.user.id;
                initiatorName.value=json && json.initiatorName || "";
                initiatorContact.value=json && json.initiatorContact || "";
                //desc.value=json && json.desc || this.txtareastr;
                self.currtypetags = json && json.tags.type || [];
                self.applicationFields = json && json.applicationFields || [];
                self.acDesc = util.replaceImgTemplate(json.desc);
                currentImgShots = json.introImgs;
            },
            getJsondata :function(cb){
                var jsondata = {
                    name:name.value.trim(),
                    startTime: startTime.value || newdate,
                    endTime: endTime.value || newdate,
                    place: place.value.trim(),
                    initiator: __page.user.id,
                    initiatorName: initiatorName.value.trim(),
                    initiatorContact: initiatorContact.value.trim(),
                    closingTime: closingTime.value.trim() || newdate,
                    pics:[],
                    //desc: desc.value.trim(),
                    desc: editor.getContentHtml() && util.events.htmlToTemplate(editor.getContentHtml()) || self.actobj.txtareastr,
                    applicationFields: getApplicationFields()
                };
                jsondata['tags'] = {
                    region:'',
                    custom:'',
                    type:self.currtypetags || []
                };
                return jsondata;
            },
            validatefield:function(jsondata){
                var errorarr = [];
                //doFormCheck
                if(validator.empty(jsondata.name)){
                    errorarr.push("活动名称不能为空");
                }
                if(self.currtypetags.length <= 0){
                    errorarr.push("请选择类型");
                }
                if(validator.empty(jsondata.place)){
                    errorarr.push("活动地点不能为空");
                }
                if(validator.empty(jsondata.initiatorName)){
                    errorarr.push("请填写发起人姓名");
                }
                if(validator.empty(jsondata.initiatorContact)){
                    errorarr.push("请填写发起人联系方式");
                }
                if(util.compareDate(util.dateFormat(newdate,'yyyy-MM-dd'),startTime.value)){
                    errorarr.push("开始时间不能早于今天");
                }
                if(util.compareDate(startTime.value,endTime.value)){
                    errorarr.push("结束时间不能早于开始时间");
                }
                if(util.compareDate(closingTime.value,startTime.value)){
                    errorarr.push("截止时间不能晚于开始时间");
                }
                return errorarr;
            },
            submitform:function(jsondata){
                var me = this;
                //prehandler
                introImgs.refresh();
                introImgsObjs = [];
                imgArr = [];
                var $html= $(util.events._wrapdiv(editor.getContentHtml()));
                //for update
                $html.find('img').each(function(i, e){
                    var exist = false;
                    for(var i = 0, len = currentImgShots.length; i < len; i ++){
                        var fileName = $(this).attr('fileName');
                        if(currentImgShots[i].name === fileName){
                            imgArr.push(currentImgShots[i]);
                            exist = true;
                            break;
                        }
                    }
                    if(!exist){
                        introImgs.localIds.push($(this).attr('localid'));
                        introImgs.fileNames.push($(this).attr('fileName'));
                    }
                })
                if(introImgs.localIds.length>0){
                    me._upload4Wx(introImgs.localIds, introImgs.serverIds, function(err){
                        if(err){
                            return util.tipssuccess(1, '上传图片失败', 0);
                        }
                        //push introimgs  && upload images
                        var image, imgShot;
                        for(var i = 0, len = introImgs.localIds.length; i < len; i++){
                            image = {
                                localId: introImgs.localIds[i],
                                name: introImgs.fileNames[i], //image original file ext.
                                mediaId: introImgs.serverIds[i]
                            };
                            introImgsObjs.push(image);
                        }
                        var invocation = multiImgUpload.newInvocation({imgArr: introImgsObjs});
                        invocation.onDone(function(data){
                            var docs = data, imgShot;
                            for(var j = 0, len = docs.length; j < len; j++){
                                imgShot = {
                                    id: docs[j]._id,
                                    name: docs[j].name,
                                    mediaId: docs[j].mediaId,
                                    localId: docs[j].localId
                                }
                                imgArr.push(imgShot);
                            };
                            model.set('introImgs', imgArr);
                            me._uploadPaObj(jsondata);
                        }).onFail(function(err){
                            alert('multiImgUpload fail');
                        }).execute();
//                        $.ajax({
//                            type: "post",
//                            url: __app.settings.api.url + "/img/images",
//                            data: {imgArr: introImgsObjs}
//                        }).success(function(data){
//                            var docs = data.result, imgShot;
//                            for(var j = 0, len = docs.length; j < len; j++){
//                                imgShot = {
//                                    id: docs[j]._id,
//                                    name: docs[j].name,
//                                    mediaId: docs[j].mediaId,
//                                    localId: docs[j].localId
//                                }
//                                imgArr.push(imgShot);
//                            };
//                            model.set('introImgs', imgArr);
//                            me._uploadPaObj(jsondata);
//                        });
                    });
                }else{
                    me._uploadPaObj(jsondata);
                }
            },
            _uploadPaObj: function(jsondata){
                //uploadimg
                if(coverimgs.localIds.length>0){
                    wx.uploadImage({
                        localId: coverimgs.localIds[0],
                        success: function (result) {
                            var image = {
                                name:util.getFileName(),
                                mediaId:result.serverId
                            }
                            imgmodel.set("myobj", image);
                            imgmodel.save();
                            imgmodel.off('save').on('save', function(res,o){
                                var imgsShot = [{
                                    id:res._id,
                                    mediaId:result.serverId,
                                    name:res.name
                                }];
                                jsondata.images = imgsShot;
                                //兼容代码--过期删除
                                jsondata.pics[0] = "/public/images/pabanner.png";
                                //如果是保存草稿，不清空图片
                                if(jsondata && jsondata.status && jsondata.status == 'd'){
                                    // _czc.push(["_trackEvent",util.getDc().PA.NAME,util.getDc().PA.ACTION.PUBLISH,self.currtypetags.join(','),self.initiator,'pubsubmitbtn']);
                                    model.set("query", {action:'draft'});
                                }else{
                                    // _czc.push(["_trackEvent",util.getDc().PA.NAME,util.getDc().PA.ACTION.PUBLISH,self.currtypetags.join(','),self.initiator,'draftsubmitbtn']);

                                    self.update();
                                    model.set("query", {action:'publish'});
                                }
                                jsondata && jsondata.status && (delete jsondata.status);
                                model.set("myobj", jsondata);
                                model.set("privateFlag", butResult);
                                model.save();
                            });
                        },
                        fail: function (res) {
                            console.error(JSON.stringify(res));
                        }
                    });
                }else{
                    if(jsondata && jsondata.status && jsondata.status == 'd'){
                        model.set("query",{action:'draft'});
                    }else{
                        model.set("query",{action:'publish'});
                    }
                    jsondata && jsondata.status && (delete jsondata.status);
                    jsondata.pics = ["/public/images/pabanner.png"];
                    model.set("myobj", jsondata);
                    model.set("privateFlag", butResult);
                    model.save();
                }
            },
            _upload4Wx:function(imgArr, resImgArr, cb) {
                var me = this;
                var len = imgArr.length, index = 0;
                function _Recursive(){
                    wx.uploadImage({
                        localId: imgArr[index],
                        success: function (result) {
                            resImgArr.push(result.serverId);
                            index++;
                            if(index <= len-1){
                                _Recursive();
                            }else{
                                if(cb){
                                    return cb();
                                }else{
                                    return;
                                }
                            }
                        },
                        fail: function (res) {
                            cb(JSON.stringify(res));
                            console.error(JSON.stringify(res));
                        }
                    });
                }
                _Recursive();
            }
        }
        var validator = util.validator();
        model.on('save',function(data,o){
            if(model.query.action == "publish"){
                //弹出新页面
                riot.route('activity/createsuccess/_' + data._id);
            }
            //保存草稿成功
            if(model.query.action == "draft"){
                model && model.query && (delete model.query);
                util.tipssuccess(0,"保存成功");
                data && data.introImgs && (currentImgShots = data.introImgs);
            }
        });
        model.on('save-error',function(){
            util.tipssuccess(1,"保存失败");
        });
        model.on('error',function(){
            util.tipssuccess(1,"保存失败");
        });
        //更改标签
        selecttags(e){
            var curritem = e.item;
            var tagindex = self.currtypetags.indexOf(curritem.name);
            if(tagindex>=0){
                return self.currtypetags.splice(tagindex,1);
            }
            return self.currtypetags.push(curritem.name);
        };
        startchange(e){
            if(startTime.value=="" && util.getBrowser().android ===false){
                startTime.value = newdate;
                startTimetxt.value = util.dateFormat(newdate,'MM/dd');
                return false;
            }
            startTimetxt.value = util.dateFormatstr(startTime.value);
            if(!endTime || endTime.value < startTime.value) {
                endTime.value = startTime.value;
                self.endchange();
            }
            if(!closingTime||closingTime.value>startTime.value) {
//                    alert(util.getYesterday(new Date(startTime.value).getTime());
                closingTime.value=startTime.value;
                self.closingchange();
            }
        };
        endchange(e){
            if(endTime.value=="" && util.getBrowser().android === false){
                endTime.value = newdate;
                endTimetxt.value = util.dateFormat(newdate,'MM/dd');
                return false;
            }
            endTimetxt.value = util.dateFormatstr(endTime.value);
        };
        closingchange(e){
            if(closingTime.value=="" && util.getBrowser().android === false){
                closingTime.value = newdate;
                closingTimebtn.value =  util.dateFormat(newdate,'MM/dd');
                return false;
            }
            closingTimebtn.value = util.dateFormatstr(closingTime.value);
        };
        publishpa(e){
            var jsondata = self.actobj.getJsondata();
            console.log("initiator=" + jsondata.initiator);
            jsondata["status"] = "o";
            var errorarr = self.actobj.validatefield(jsondata);
            if(errorarr.length>0){
                //errorHandler
                util.tipssuccess(1,errorarr[0],1);
                return;
            }
            self.actobj.submitform(jsondata);
        };
        submitdraft(e){
            var jsondata = self.actobj.getJsondata();
            jsondata["status"] = "d";
            var errorarr = self.actobj.validatefield(jsondata);
            if(errorarr.length>0){
                //errorHandler
                util.tipssuccess(1,errorarr[0],1);
                return;
            }
            self.actobj.submitform(jsondata);
        };
        //展开更多选项
        moreOptions(e){
            $(".options").slideToggle();
            $(".activity-new-more-options-title").toggleClass("activity-new-more-options-title-checked");
        };
        var startX,endPageX, butResult = false;
        //设置按钮事件
        var setaddEventListeners =function(){
            var but_radius = document.getElementById("but_wary");
            but_radius.addEventListener("touchstart", touchStartBut_Radius, false);
            but_radius.addEventListener("touchmove", touchmoveBut_Radius, false);
            but_radius.addEventListener("touchend", touchendBut_Radius, false);
        };
        var touchStartBut_Radius = function(event){
            event.preventDefault();
            var event = event || window.event;
            startX = event.touches[0].pageX;
        };
        var touchmoveBut_Radius = function(event){
            event.preventDefault();
            var event = event || window.event;
            endPageX = event.touches[0].pageX;
        }
        var touchendBut_Radius = function(){
            if(endPageX>startX){
                $(".but_wary").addClass("but_right");
                $(".but_wary").removeClass("but_left");
                butResult = true;
            }else if(endPageX<startX){
                $(".but_wary").addClass("but_left");
                $(".but_wary").removeClass("but_right");
                butResult = false;
            }
            startX=0;
            endPageX=0;
        };
        self.on('toabsolute',function(){
            btnbox.style.position = "absolute";
            btnbox.style.bottom = "0px";
        });
        self.on('tofixed',function(){
            btnbox.style.position = "fixed";
            btnbox.style.bottom = "0px";
        });
        inputonfocus(e){
            self.trigger('toabsolute');
        };
        inputonblur(e){
            self.trigger('tofixed');
        };
        descfocus(e){
            self.trigger('toabsolute');
        };
        descblur(e){
            self.trigger('tofixed');
        };
        //iphone兼容
        var u = navigator.userAgent;
        if(!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)) {
            dateclick(e){
                self.trigger('toabsolute');
            };
            dateblur(e) {
                self.trigger('tofixed');
            };
        };
        //类型标签展开效果
        showSelectType(e){
            var className = $(".tag-type").attr("class");
            if(className.indexOf("animation-show") > 0){
                $(".tag-type").removeClass("animation-show").addClass("animation-hide");
            }else{
                $(".tag-type").removeClass("animation-hide").addClass("animation-show");
            }
        };

        var _open = function(options){
            this.trigger('ready', false);
            model.set('_id',options || self.opts._id);
            model.fetch({action:'open'});
        }.bind(self);

        model.on('fetch',function(json){
            self.fecthjson = json;
            self.actobj.initPage(self.fecthjson);
            self.picshow = util.calcImageUrl(self.fecthjson);
            self.trigger('ready', true);
            self.trigger('view-route-to');
            //初始化富文本编辑器
            editor.init();
            editor.reset();
            showDesc(self.acDesc);
            $("#contentdiv").on("focus", function(){
                self.trigger('toabsolute');
            });
            $("#contentdiv").on("blur", function(){
                self.trigger('tofixed');
            });
            editor.off('chooseImgBegin').on('chooseImgBegin', function(opts) {
                wx.chooseImage({
                    success: function (res) {
                        editor.trigger('chooseImgComplete', res.localIds[0]);
                    }
                });
            });
            self.update();
            setaddEventListeners();
        });

        this.on('mount', function(){
            console.info('tag activities is mounted');

        });

        this.on('open', function(options){
            console.info('tag activities is opening');
            _open(options);
            self.test = true;
            wx.ready(function(){
                self.uploadimg=function(e){
                    wx.chooseImage({
                        success: function (res) {
                            coverimgs.refresh();
                            coverimgs.localIds[0] = res.localIds[0];
                            self.test = false;
                            self.update();
                            var $banner = $("#banner");
                            $banner.attr("src",res.localIds[0]);
                        }
                    });
                };
                self.update();
            });
        });

        //get application fields array
        var getApplicationFields = function(){
            var appFieldsArr = [];
            var appFieldsInfo = $(".user_options .checked");
            for(var i = 0; i < appFieldsInfo.length; i++){
                appFieldsArr.push(self.appFields[$(appFieldsInfo[i]).attr("data")]);
            }
            return appFieldsArr;
        }
        //选择用户填写类型
        userOptions(e){
            if(e.target.outerText != "姓名" && e.target.outerText != "手机"){
                $(e.target).toggleClass("checked");
            }
        }
        //判断报名选项是否已选择
        self.fieldIfSel = function(name){
            var seled = false;
            for(var i = 0, len = self.applicationFields.length; i < len; i++){
                if(self.applicationFields[i].name == name){
                    seled = true;
                    break;
                }
            }
            return seled;
        };
        //返回首页
        homepage(e){
            riot.route('activity/index');
        };

        //富文本编辑器回填数据
        var showDesc = function(desc){
            $("#contentdiv").html(desc);
        }
        //富文本更新数据

    </script>
</activity-edit>
<student-index>
    <div if="{!hidden}">
        <div><label>昵称：</label>{__page.user.wx_nickname}</div>
        <div><label>姓名：</label>{__page.user.name}</div>
        <div><label>手机：</label>{__page.user.name}</div>
        <hr>
        <label>教师私信</label>
        <hr>
        <div class="private-msg"></div>
        <label>班级信息</label>
        <hr>
        <div each="{clazzes}" class="clazz-card" data-clazzid="{clazz}" onclick="{parent.enterClazz}">
            <span>{_id} {name}</span>
        </div>
    </div>
    <style scoped>
        .clazz-card{
            height: 40px;
            line-height: 40px;
            background: red;
            margin-bottom: 10px;
        }
        .private-msg{
            height:48px;
            line-height: 48px;
            background: green;
            text-align: center;
        }
    </style>

    <script>
        var self = nest.presentable(this),
                ClazzFetchByStudentAction = domain.action("ClazzFetchByStudentAction");
        self.clazzes = [];
        var _open = function(data){
            ClazzFetchByStudentAction.execute();
        }.bind(self);
        var _refresh = function(){

        }.bind(self);
        this.on('open', function(options){
            _open(options);
        });
        this.on('mount',function(){
            ClazzFetchByStudentAction.onDone(OnClazzFetchByStudentAction);
        });

        this.on('refresh', function(){
            _refresh();
        });

        function OnClazzFetchByStudentAction(data){
            console.log(data)
            self.clazzes = data.clazzes;
            self.trigger('view-route-to');
        }
        enterClazz(e){
            riot.route('clazz/notifies?clazzId=' + e.currentTarget.getAttribute('data-clazzid'));
        }
    </script>
</student-index>
<component-date>
    <input type="text" id="{dateidtext}" value="00/00/00" readonly="readonly"/>
    <input id="{dateid}" onchange="{datechange}" onclick="{dateclick}" onblur="{dateblur}"  style="display: inline-block;margin-top:0px;" type="date"/>
    <script>
        var self = nest.presentable(this);
        self.dateid = this.opts.dateid;
        self.datename = this.opts.datename;
        self.dateidtext = this.opts.dateidtext;
        var newdate = self.newdate = new Date(__page.servertime);
        self.on('toabsolute',function(){
            self.parent.btnbox.style.position = "absolute";
            self.parent.btnbox.style.bottom = "0px";
            self.parent.btnbox2.style.position = "absolute";
            self.parent.btnbox2.style.bottom = "0px";
        });

        self.on('tofixed',function(){
            self.parent.btnbox.style.position = "fixed";
            self.parent.btnbox.style.bottom = "0px";
            self.parent.btnbox2.style.position = "fixed";
            self.parent.btnbox2.style.bottom = "0px";
        });

        //iphone兼容
        var u = navigator.userAgent;
        if(!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)) {
            dateclick(e){
                self.trigger('toabsolute');
            };
            dateblur(e){
                self.trigger('tofixed');
            };
        };

        datechange(e){
            var date = document.querySelector('#' + self.dateid);
            var dateText = document.querySelector('#' + self.dateidtext);
            if(date.value == "" && util.getBrowser().android ===false){
                date.value = newdate;
                dateText.value = util.dateFormat(newdate, 'yyyy/MM/dd');
                return false;
            }
            dateText.value = util.dateFormat(new Date(date.value), 'yyyy/MM/dd');
        };
    </script>
</component-date>